<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>OSINT Report for {{ sh_domain }}</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Mono&family=IBM+Plex+Sans:wght@400;600&family=IBM+Plex+Mono&family=Fira+Sans:wght@400;600&family=Fira+Code&family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style media="print">
	@page { size: A4; margin: 20mm; }
	body { padding:0!important; background:#fff!important; color:#000!important; }
	.control-panel, .toc-container, .back-to-top { display:none!important; }
	h1,h2,h3 { page-break-after:avoid; }
	section { page-break-inside:avoid; }
</style>

<style>
	:root{
	  --bg-color:#fff;--text-color:#333;--link-color:#007bff;
	  --accent-color:#333399;--hr-color:#ccc;
	  --font-main:'Inter',sans-serif;--font-code:'Roboto Mono',monospace;
	}
	body.dark{
	  --bg-color:#1e1e1e;--text-color:#ccc;--link-color:#7ca9ff;
	  --accent-color:#9db2ff;--hr-color:#444;
	}
	*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
	html{scroll-behavior:smooth;}

	body{
	  font:15px/1.6 var(--font-main);
	  background:var(--bg-color);color:var(--text-color);
	  padding:24px 24px 24px 260px;
	  transition:background .3s,color .3s;
	}

	h1,h2,h3{text-align:center;font-weight:700;font-family:var(--font-main);margin:24px 0 12px;}
	h1{font-size:28px;text-decoration:underline;}
	h2{font-size:22px;}
	h3{font-size:18px;text-decoration:underline;margin-top:36px;}

	p{margin:6px 0 12px;}
	ul{margin:6px 0 12px 24px;}
	li{margin:4px 0;}
	hr{margin:24px 0;border:none;border-top:1px solid var(--hr-color);}
	pre,code{font-family:var(--font-code);color:var(--accent-color);white-space:pre-wrap;margin:12px 0;}

	.blue{color:var(--accent-color);}
	.red{color:#f00;}
	.maroon{color:#800000;}
	.underline{text-decoration:underline;}

	.toc-container{
	  position:fixed;top:0;left:0;width:240px;height:100vh;overflow-y:auto;
	  background:var(--bg-color);border-right:1px solid var(--hr-color);
	  padding:20px 10px;font-family:var(--font-main);
	}
	.toc-section-title{text-align:center;margin:10px 0 8px;font-weight:bold;}
	.toc-link{display:block;text-align:center;margin-bottom:6px;
			  color:var(--link-color);text-decoration:none;}
	.toc-link:hover{text-decoration:underline;}
	.toc-link.active{font-weight:700;background:var(--accent-color);color:#fff;border-radius:4px;}

	.control-panel{
	  position:fixed;top:10px;right:20px;z-index:1000;
	  display:flex;flex-direction:column;align-items:center;gap:8px;
	  background:var(--bg-color);padding:10px 14px;
	  border:1px solid var(--hr-color);border-radius:6px;
	  box-shadow:0 2px 6px rgba(0,0,0,.08);
	}
	.theme-toggle,.font-select{
	  background:var(--bg-color);color:var(--text-color);
	  border:1px solid var(--hr-color);border-radius:4px;
	  font-family:var(--font-main);transition:background .3s,color .3s;
	}
	.theme-toggle{padding:6px 12px;cursor:pointer;}
	.font-select{padding:6px 8px;}
	.back-to-top{text-align:right;margin-top:16px;}

	details summary{cursor:pointer;font-weight:bold;margin-bottom:6px;}
	details[open]>summary::after{content:" ‚ñ≤";float:right;}
	details>summary::after{content:" ‚ñº";float:right;}
</style>
</head>

<body id="top">

<div class="control-panel">
  <button class="theme-toggle" onclick="toggleTheme()">üåì Theme</button>
  <button id="printBtn" class="theme-toggle">üñ®Ô∏è Print</button>
  <select id="fontSelect" onchange="changeFont(this.value)" class="font-select">
    <option value="inter">Inter + Roboto Mono</option>
    <option value="plex">IBM Plex Sans + Mono</option>
    <option value="fira">Fira Sans + Fira Code</option>
    <option value="grotesk">Space Grotesk + Roboto Mono</option>
  </select>
</div>

<div class="toc-container">
  <h2 class="underline">Table of contents</h2>
  <a href="#general-scan-info" class="toc-link">1. General scan information</a> 
  <a href="#general-scan-info" class="toc-link">2. General scan statistics</a> 
  <p class="toc-section-title maroon underline">[BASIC SCAN INFO]</p>
  <a href="#whois-info" class="toc-link">3. WHOIS information</a>
  <a href="#social-media-links" class="toc-link">4. Social media links</a>
  <a href="#subdomains-info" class="toc-link">5. Subdomains</a>
  <a href="#dns-ssl-info" class="toc-link">6. DNS & SSL</a>
  <a href="#services-frameworks-info" class="toc-link">7. Services & Frameworks</a>
  <a href="#pre-pentest-info" class="toc-link">8. Pre-Pentest Info</a>
  <a href="#pre-pentest-info" class="toc-link">9. Website configuration files</a>
  <p class="toc-section-title maroon underline">[DORKING SCAN INFO]</p>
  <a href="#dorking-info" class="toc-link">10. Dorking Results</a>
  <p class="toc-section-title maroon underline">[PAGESEARCH SCAN INFO]</p>
  <a href="#pagesearch-results" class="toc-link">11. PageSearch Results</a>
  <p class="toc-section-title maroon underline">[API SCAN INFO]</p>
  <a href="#virustotal-results" class="toc-link">12. VirusTotal</a>
  <a href="#securitytrails-results" class="toc-link">13. SecurityTrails</a>
  <a href="#hudsonrock-results" class="toc-link">14. HudsonRock</a>
</div>

<h1>Open Source Information Research Report</h1>
<h2>{{ org }}</h2>
<hr>

<h3 id="general-scan-info">GENERAL SCAN INFORMATION</h3>
<p><strong>Status of robots.txt extraction:</strong> <span class="blue">{{ robots_txt_result }}</span></p>
<p><strong>Status of sitemap.xml extraction:</strong> <span class="blue">{{ sitemap_xml_result }}</span></p>
<p><strong>Status of sitemap.xml links extraction:</strong><span class="blue">{{ sitemap_links }}</span></p>
<p><strong>Google Dorking status:</strong> <span class="blue">{{ dorking_status }}</span></p>
<p><strong>PageSearch conduction:</strong> <span class="blue">{{ pagesearch_ui_mark }}</span></p>
<p><strong>Snapshotting conduction:</strong> <span class="blue">{{ snapshotting_ui_mark }}</span></p>
<p><strong>Report creation time:</strong> <span class="blue">{{ ctime }}</span></p>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="general-scan-info">GENERAL SCAN STATISTICS</h3>
<div style="display: flex; align-items: flex-start; gap: 80px;">
  <div>
	<p><strong>Total subdomains found:</strong> <span class="blue" id="a_tsf">{{ a_tsf }}</span></p>
	<p><strong>Total social media links found:</strong> <span class="blue" id="a_tsm">{{ a_tsm }}</span></p> 
	<p><strong>Total emails found:</strong> <span class="blue" id="a_temails">{{ a_temails }}</span></p> 
	<p><strong>Total associated IP addresses found:</strong> <span class="blue" id="a_tips">{{ a_tips }}</span></p> 
	<p><strong>Total open ports found:</strong> <span class="blue" id="a_tops">{{ a_tops }}</span></p> 
	<p><strong>Total potential vulnerabilities found:</strong> <span class="blue" id="a_tpv">{{ a_tpv }}</span></p> 
	<p><strong>Accessible subdomains (PageSearch):</strong> <span class="blue" id="ps_s">{{ ps_s }}</span></p>
	<p><strong>Email addresses (PageSearch):</strong> <span class="blue" id="ps_e">{{ ps_e }}</span></p>
	<p><strong>Found documents (PageSearch):</strong> <span class="blue" id="ps_f">{{ ps_f }}</span></p>
	<p><strong>Found cookies (PageSearch):</strong> <span class="blue" id="ps_c">{{ ps_c }}</span></p>
	<p><strong>Found API keys (PageSearch):</strong> <span class="blue" id="ps_a">{{ ps_a }}</span></p>
	<p><strong>Found WEB elements (PageSearch):</strong> <span class="blue" id="ps_w">{{ ps_w }}</span></p>
	<p><strong>Exposed passwords (PageSearch):</strong> <span class="blue" id="ps_p">{{ ps_p }}</span></p>
  </div>
  <div style="width: 700px; height: 700px; margin-top: 80px;">
    <canvas id="statsChart"></canvas>
  </div>
</div>
<hr>

<h3 id="whois-info">WHOIS INFORMATION</h3>
<p><strong>Domain:</strong> <span class="blue">{{ sh_domain }}</span></p>
<p><strong>Full URL:</strong> <a href="{{ full_url }}" target="_blank" class="blue">{{ full_url }}</a></p>
<p><strong>IP address:</strong> <span class="blue">{{ ip_address }}</span></p>
<p><strong>Registrar:</strong> <span class="blue">{{ registrar }}</span></p>
<p><strong>Creation date:</strong> <span class="blue">{{ creation_date }}</span></p>
<p><strong>Expiration date:</strong> <span class="blue">{{ expiration_date }}</span></p>
<p><strong>Organization name:</strong> <span class="blue">{{ org }}</span></p>
<p><strong>Contact e-mails:</strong> <span class="blue">{{ mails }}</span></p>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="social-media-links">SOCIAL MEDIA LINKS</h3>
<p><strong>FACEBOOK:</strong></p>
<ul>
  {% for link in fb_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>TWITTER (+ X.com):</strong></p>
<ul>
  {% for link in tw_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
  {% for link in xcom_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>INSTAGRAM:</strong></p>
<ul>
  {% for link in inst_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>TELEGRAM:</strong></p>
<ul>
  {% for link in tg_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>TIKTOK:</strong></p>
<ul>
  {% for link in tt_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>LINKEDIN:</strong></p>
<ul>
  {% for link in li_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>VKONTAKTE:</strong></p>
<ul>
  {% for link in vk_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>YOUTUBE:</strong></p>
<ul>
  {% for link in yt_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>ODNOKLASSNIKI:</strong></p>
<ul>
  {% for link in ok_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>

<p><strong>WECHAT:</strong></p>
<ul>
  {% for link in wc_links %}
    <li>‚áí <a href="{{ link }}" target="_blank" class="blue">{{ link }}</a></li>
  {% endfor %}
</ul>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="subdomains-info">SUBDOMAINS</h3>
<p><strong>Found subdomains:</strong></p>
<ul>
  {% for sd in subdomains %}
    <li>‚áí <a href="https://{{ sd }}" target="_blank" class="blue">{{ sd }}</a></li>
  {% endfor %}
</ul>

<p><strong>Subdomains IP addresses:</strong></p>
<ul>
  {% for sdip in subdomain_ip %}
    <li class="blue">‚áí {{ sdip }}</li>
  {% endfor %}
</ul>

<p><strong>Subdomains e-mails:</strong></p>
<ul>
  {% for smails in subdomain_mails %}
    <li class="blue">‚áí {{ smails }}</li>
  {% endfor %}
</ul>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="dns-ssl-info">DNS & SSL INFORMATION</h3>
<p><strong>(DNS) Name servers:</strong> <span class="blue">{{ name_servers }}</span></p>
<p><strong>(DNS) MX addresses:</strong> <span class="blue">{{ mx_records }}</span></p>
<p><strong>(SSL) Issuer:</strong> <span class="blue">{{ issuer }}</span></p>
<p><strong>(SSL) Subject:</strong> <span class="blue">{{ subject }}</span></p>
<p><strong>(SSL) Not before:</strong> <span class="blue">{{ notBefore }}</span></p>
<p><strong>(SSL) Not after:</strong> <span class="blue">{{ notAfter }}</span></p>
<p><strong>(SSL) Certificate name:</strong> <span class="blue">{{ commonName }}</span></p>
<p><strong>(SSL) Certificate serial number:</strong> <span class="blue">{{ serialNumber }}</span></p>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="services-frameworks-info">SERVICES & FRAMEWORKS INFORMATION</h3>
<p><strong>Web servers:</strong></p>
<ul>
  {% for ws in web_servers %}
    <li class="blue">‚áí {{ ws }}</li>
  {% endfor %}
</ul>

<p><strong>CMS:</strong></p>
<ul>
  {% for cm in cms %}
    <li class="blue">‚áí {{ cm }}</li>
  {% endfor %}
</ul>

<p><strong>Used programming languages:</strong></p>
<ul>
  {% for pl in programming_languages %}
    <li class="blue">‚áí {{ pl }}</li>
  {% endfor %}
</ul>

<p><strong>Used web frameworks:</strong></p>
<ul>
  {% for wf in web_frameworks %}
    <li class="blue">‚áí {{ wf }}</li>
  {% endfor %}
</ul>

<p><strong>Analytics service:</strong></p>
<ul>
  {% for analytic in analytics %}
    <li class="blue">‚áí {{ analytic }}</li>
  {% endfor %}
</ul>

<p><strong>Used JavaScript frameworks:</strong></p>
<ul>
  {% for jsf in javascript_frameworks %}
    <li class="blue">‚áí {{ jsf }}</li>
  {% endfor %}
</ul>

<p><strong>Tags:</strong></p>
<ul>
  {% for tag in tags %}
    <li class="blue">‚áí {{ tag }}</li>
  {% endfor %}
</ul>

<p><strong>Common Platform Enumeration:</strong></p>
<ul>
  {% for cpe in cpes %}
    <li class="blue">‚áí {{ cpe }}</li>
  {% endfor %}
</ul>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>

<h3 id="pre-pentest-info">BASIC PRE-PENTEST INFORMATION</h3>
<p><strong>Open ports:</strong></p>
<ul>
  {% for op in ports %}
    <li class="blue">‚áí {{ op }}</li>
  {% endfor %}
</ul>

<p><strong>Hostnames:</strong></p>
<ul>
  {% for hn in hostnames %}
    <li class="blue">‚áí {{ hn }}</li>
  {% endfor %}
</ul>

<p><strong>Potential vulnerabilities:</strong></p>
<ul>
  {% for vuln in vulns %}
    <li class="blue">‚áí {{ vuln }}</li>
  {% endfor %}
</ul>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>


<h3 id="technical-files">WEBSITE TECHNICAL FILES</h3>
<details>
  <summary>robots.txt</summary>
  <pre>{{ robots_content | safe }}</pre>
</details>

<details>
  <summary>sitemap.xml</summary>
  <pre>{{ sitemap_xml_content | safe }}</pre>
</details>

<details>
  <summary>Sitemap links</summary>
  <pre>{{ sitemap_txt_content | safe }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>


{% if add_dsi %}
<h3 id="dorking-info">DORKING SCAN INFO</h3>
<details>
  <summary>Dorking Results</summary>
  <pre>{{ add_dsi | safe }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>
{% endif %}

{% if ps_string %}
<h3 id="pagesearch-results">PAGESEARCH RESULTS</h3>
<details>
  <summary>PageSearch Process Listing</summary>
  <pre>{{ ps_string }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>
{% endif %}

{% if virustotal_output %}
<h3 id="virustotal-results">VIRUSTOTAL API SCAN RESULTS</h3>
<details>
  <summary>VirusTotal Output</summary>
  <pre>{{ virustotal_output | safe }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>
{% endif %}

{% if securitytrails_output %}
<h3 id="securitytrails-results">SECURITYTRAILS API SCAN RESULTS</h3>
<details>
  <summary>SecurityTrails Output</summary>
  <pre>{{ securitytrails_output | safe }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>
{% endif %}

{% if hudsonrock_output %}
<h3 id="hudsonrock-results">HUDSONROCK API SCAN RESULTS</h3>
<details>
  <summary>HudsonRock Output</summary>
  <pre>{{ hudsonrock_output | safe }}</pre>
</details>
<div class="back-to-top"><a href="#top" class="toc-link">‚Üë Back to top</a></div>
<hr>
{% endif %}

<h3 style="text-align:center; padding-top: 10px;">Created using DPULSE software by OSINT-TECHNOLOGIES</h3>
<p style="text-align:center;">Visit our web-pages:</p>
<ul style="text-align:center; list-style: none; padding-left: 0;">
  <li><a href="https://github.com/OSINT-TECHNOLOGIES" target="_blank" class="blue">https://github.com/OSINT-TECHNOLOGIES</a></li>
  <li><a href="https://pypi.org/project/dpulse/" target="_blank" class="blue">https://pypi.org/project/dpulse/</a></li>
</ul>

<script>
const fontMap={
  inter:{main:"'Inter', sans-serif",code:"'Roboto Mono', monospace"},
  plex:{main:"'IBM Plex Sans', sans-serif",code:"'IBM Plex Mono', monospace"},
  fira:{main:"'Fira Sans', sans-serif",code:"'Fira Code', monospace"},
  grotesk:{main:"'Space Grotesk', sans-serif",code:"'Roboto Mono', monospace"}
};

function changeFont(val){
  const c=fontMap[val]||fontMap.inter;
  document.documentElement.style.setProperty('--font-main',c.main);
  document.documentElement.style.setProperty('--font-code',c.code);
  localStorage.setItem('fontChoice',val);
}

function toggleTheme(){
  document.body.classList.toggle('dark');
  localStorage.setItem('theme',document.body.classList.contains('dark')?'dark':'light');
}

function initActiveToc(){
  const links=document.querySelectorAll('.toc-link[href^="#"]');
  const sections=[...links].map(l=>document.querySelector(l.getAttribute('href'))).filter(Boolean);
  const obs=new IntersectionObserver(ent=>{
    ent.forEach(e=>{
      const id=e.target.id;
      const link=document.querySelector(`.toc-link[href="#${id}"]`);
      if(link) e.isIntersecting?link.classList.add('active'):link.classList.remove('active');
    });
  },{rootMargin:'-50% 0px -50% 0px',threshold:0});
  sections.forEach(s=>obs.observe(s));
}

function bindPrintPdf(){
  const printBtn=document.getElementById('printBtn');
  const pdfBtn=document.getElementById('pdfBtn');
  if(printBtn) printBtn.addEventListener('click',()=>window.print());
  if(pdfBtn) pdfBtn.addEventListener('click',()=>{
    const el=document.querySelector('main');
    const opt={margin:0.5,filename:`OSINT_Report_${document.title}.pdf`,
      image:{type:'jpeg',quality:0.98},
      html2canvas:{scale:2,useCORS:true},
      jsPDF:{unit:'in',format:'a4',orientation:'portrait'}};
    if(window.html2pdf) html2pdf().set(opt).from(el).save();
    else console.error('html2pdf not loaded');
  });
}

window.addEventListener('DOMContentLoaded',()=>{
  if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark');
  const saved=localStorage.getItem('fontChoice')||'inter';
  document.getElementById('fontSelect').value=saved;
  changeFont(saved);
  bindPrintPdf();

  if (window.Chart) { 
    const stats = [
      parseInt(document.getElementById('a_tsf')?.textContent) || 0,
      parseInt(document.getElementById('a_tsm')?.textContent) || 0,
      parseInt(document.getElementById('a_temails')?.textContent) || 0,
      parseInt(document.getElementById('a_tips')?.textContent) || 0,
      parseInt(document.getElementById('a_tops')?.textContent) || 0,
      parseInt(document.getElementById('a_tpv')?.textContent) || 0,
      parseInt(document.getElementById('ps_s')?.textContent) || 0,
      parseInt(document.getElementById('ps_e')?.textContent) || 0,
      parseInt(document.getElementById('ps_f')?.textContent) || 0,
      parseInt(document.getElementById('ps_c')?.textContent) || 0,
      parseInt(document.getElementById('ps_a')?.textContent) || 0,
      parseInt(document.getElementById('ps_w')?.textContent) || 0,
      parseInt(document.getElementById('ps_p')?.textContent) || 0
    ];

    const labels = [
      'Subdomains',
      'Social Media',
      'Emails',
      'IP Addresses',
      'Open Ports',
      'Vulnerabilities',
      'Accessible subdomains',
      'Email addresses',
      'Found documents',
      'Found cookies',
      'Found API keys',
      'WEB elements',
      'Exposed passwords'
    ];

    const colors = [
      '#4caf50', '#2196f3', '#ff9800', '#9c27b0', '#f44336', '#607d8b',
      '#00bcd4', '#8bc34a', '#ffc107', '#e91e63', '#3f51b5', '#795548', '#9e9e9e'
    ];

    const ctx = document.getElementById('statsChart')?.getContext('2d');
    if (ctx) {
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Count',
            data: stats,
            backgroundColor: colors
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            title: { display: false }
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }
  }
});
</script>
</body>
</html>
